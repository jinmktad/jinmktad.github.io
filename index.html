<!DOCTYPE html><html lang="ko"><head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>상담 문의 | Leadmakers</title>
  <style>
    body{font-family:"Noto Sans KR",system-ui,apple-system,sans-serif;background:#f7f8fa;margin:0}
    .wrap{min-height:100vh;display:grid;place-items:center;padding:40px 16px}
    .card{width:100%;max-width:520px;background:#fff;border:1px solid #e5e7eb;border-radius:16px;box-shadow:0 8px 22px rgba(0,0,0,.08);padding:28px}
    h2{margin:0 0 18px;font-size:22px}
    .muted{color:#6b7280;margin:-6px 0 18px;font-size:14px}
    label{display:block;margin:12px 0 6px;font-weight:600}
    input,select,textarea{width:100%;padding:12px 14px;border:1px solid #d1d5db;border-radius:10px;font-size:15px;box-sizing:border-box}
    textarea{min-height:110px;resize:vertical}
    button{margin-top:18px;width:100%;padding:14px;border:0;border-radius:12px;background:#111827;color:#fff;font-weight:700;cursor:pointer}
    button:hover{background:#0b1220}
    .success,.error{display:none;margin-top:14px;font-weight:600;text-align:center}
    .success{color:#059669}
    .error{color:#b91c1c}
  </style></head><body>
  <main class="wrap">
    <section class="card">
      <h2>상담 문의</h2>
      <p class="muted">아래 정보를 남겨주시면 영업시간(월~토 09:00~18:00) 내 연락드립니다.</p>

      <form id="leadForm">
        <label>이름</label>
        <input id="name" required placeholder="홍길동" />

        <label>전화번호</label>
        <input id="phone" type="tel" required placeholder="010-1234-5678" />

        <label>이메일</label>
        <input id="email" type="email" placeholder="you@example.com" />

        <label>현장명</label>
        <input id="site" placeholder="예: ○○ 모델하우스 / ○○지점" />

        <label>지역</label>
        <select id="region">
          <option value="">지역을 선택하세요</option>
          <option>서울</option><option>경기</option><option>인천</option>
          <option>강원</option><option>충청</option><option>전라</option>
          <option>경상</option><option>제주</option>
        </select>

        <label>문의 유형</label>
        <select id="category">
          <option value="">선택하세요</option>
          <option>분양문의</option><option>창업상담</option>
          <option>정책자금</option><option>언론홍보</option><option>기타</option>
        </select>

        <label>메시지</label>
        <textarea id="message" placeholder="원하시는 상담 내용을 적어주세요."></textarea>

        <button type="submit">제출하기</button>
        <div id="ok" class="success">🎉 성공적으로 제출되었습니다!</div>
        <div id="ng" class="error">전송 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요.</div>
      </form>
    </section>
  </main>

  <script>
    // ✅ 새로 배포된 Apps Script URL이 적용되었습니다! 
    const ENDPOINT = "https://script.google.com/macros/s/1M20aJcb8YTNNaOlCR7EQ7S3KgLi_bC6XbPlxOb_tuL2CS2kcbjcCDV/exec";
    function getUTM(){
      const u = new URL(location.href), g=k=>u.searchParams.get(k)||"";
      return { utm_source:g('utm_source'), utm_medium:g('utm_medium'),
               utm_campaign:g('utm_campaign'), utm_term:g('utm_term'),
               utm_content:g('utm_content') };
    }

    document.getElementById("leadForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      
      const submitButton = e.target.querySelector('button[type="submit"]');
      submitButton.disabled = true;
      submitButton.textContent = '제출 중...';

      const data = {
        name: document.getElementById("name").value.trim(),
        phone: document.getElementById("phone").value.trim(),
        email: document.getElementById("email").value.trim(),
        site: document.getElementById("site").value.trim(),
        region: document.getElementById("region").value,
        category: document.getElementById("category").value,
        message: document.getElementById("message").value.trim(),
        ...getUTM(),
        referrer: document.referrer || "",
        user_agent: navigator.userAgent || "",
        page: location.href
      };

      try{
        const response = await fetch(ENDPOINT, {
          method: "POST",
          mode: "no-cors", 
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });
        
        // 🚨 응답 상태와 관계없이 (no-cors 모드이므로), 리다이렉트 실행
        location.href = "/thank-you.html"; 

      }catch(err){
        submitButton.disabled = false;
        submitButton.textContent = '제출하기';
        document.getElementById("ng").style.display = "block";
        document.getElementById("ok").style.display = "none";
        console.error("Fetch Error:", err);
      }
    });
  </script></body></html>
