function doPost(e) {
  var SHEET_ID = '1Ocl6J7CYDli6HEH2J9qhzVcS76P8u6OHnnLZfPQva6s';
  var SHEET_NAME = '시트1';

  var ss = SpreadsheetApp.openById(SHEET_ID);
  var sh = ss.getSheetByName(SHEET_NAME);

  var data = {};
  try {
    if (e && e.postData && e.postData.contents) {
      data = JSON.parse(e.postData.contents);
    } else {
      data = e.parameter || {};
    }
  } catch (_) {
    data = e && e.parameter ? e.parameter : {};
  }

  var now = Utilities.formatDate(new Date(), 'Asia/Seoul', 'yyyy-MM-dd HH:mm:ss');

  sh.appendRow([
    now,
    data.name || '',
    data.phone || '',
    data.email || '',
    data.message || '',
    data.utm_source || '',
    data.utm_medium || '',
    data.utm_campaign || '',
    data.utm_term || '',
    data.utm_content || '',
    data.referrer || '',
    data.user_agent || '',
    data.page || ''
  ]);

  return ContentService.createTextOutput('OK').setMimeType(ContentService.MimeType.TEXT);
}
